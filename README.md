# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


В качестве парадгимы для реализации проекта была выбрана MVP - парадгима.
Связь между слоями осуществляется за счёт событийно-ориентированного подхода. В свою очередь, код презентера не выделяется в отдельный класс и размещен в основном скрипте приложение - index.ts
Исходя из нее, весь код поделен на три части: слой данных (model), слой представления (view) и презентер (presenter), который связывает два предыдущих слоя между собой. 

## Типы данных

### Данные товара

interface IWebLarekData {
    id: number;
    description: string;
    image: string;
    title: string;
    category: string;
    price: number
  }

type IWebLarekItem = Pick<IWebLarekData, 'id' | 'title' | 'category' | 'price'>

type IWebLarekItemBasket = Pick<IWebLarekData, 'id' | 'title' | 'price'>

type IWebLarekDataID = Pick<IWebLarekData, 'id'>

### Данные формы

interface IFormData {
  address: string
  payment: string
  emailAdress: string
  phoneNumber: string
}

### Ошибки ввода формы

type FormErrors = Partial<Record<keyof IFormData, string>>;

### Основной класс форм

interface IForm {
  form: IFormData;
  formErrors: FormErrors;
  valid: boolean;
  setField(field: keyof IFromData, value: string): void
}

### Корзина

interface IBasket {
  items: [];
  add(id: string): void;
  remove(id: string): void
}

## Архитектура проекта

## base

### Класс Api
Класс отвечает за логику запросов на сервер.
Конструктор класса содержит базовый адрес сервера и объект с заголовками запроса.
Класс имеет такие методы:
• get - для выполнения GET запроса по указанному адресу, возращает ответ с сервера в виде объекта;
• post - для передачи указанных данных по указанному адресу;
• handleResponse - для проверки статуса ответа с сервера и в случае ошибки - выведения данной ошибки.

### Класс EventEmitter
Класс отвечает за работу связанную с событиями. Их создание, подписка на них.
Конструктор класса содержит событие, которое будет генирироваться при вызове.
Класс имеет такие методы:
• on - для установки обработчика на событие;
• off - для снятия обработчика с события;
• emit - для инициирования события с данными;
• onAll - для включения возможности слушать все события;
• ofAll - для сброса всех обработчиков;
• trigger - для создания коллбек триггера, генерирующего событие при вызове.

### Класс WebShopApi
Класс отвечает за действия с API и является дочерним классу Api.
Конструктор класса содержит строку cdn.
Класс имеет методы:
• getProduct - для получения товара с сервера;
• getProductsList - для получения всего списка товаров с сервера;
• postUserOrder - для отправки запроса пользователя на покупу выбранных товаров.

## View

### Класс Component
Класс отвечает за отображение компонентов и является родительским классом для всех компонентов отображения.
Конструктор класса содержит контейнер с которым будут производится дальнейшие действия.
Класс Component является дженериком и будет принимать в себя следующие типы: 
<IWebLarekItemPage>, <Page>, <Success>, <Modal>, <Form>, <BasketCompenent>, <ProductComponent>. 
Класс имеет такие методы:
• toggleClass - для переключения класса переданного элемента;
• setText - для установки текстового содержимого переданному элементу;
• setDisabled - для изменения статуса блокировки переданного элемента;
• setHidden - для сокрытия переданного элемента;
• setVisible - для показа переданного элемента;
• setImage - для установки переданному элементу изображения с альтернативным текстом;
• render - для возвращения корневого DOM-элемента.

### Класс BasketComponent
Класс отвечает за отображение корзины на сайте.
Конструктор класса содержит контейнер и события.
Класс имеет методы:
• set items - для передачи массива уже созданных карточек товара;
• deleteItem - для удаления товары из корзины;
• submit - для перехода к следующему шагу оформления заказа (следующей модалке).
• calculateTotal - для подсчета общей суммы заказа;
• showTotal - для выведения общей суммы заказа в (.basket__price).

### ProductComponent
Класс отвечает за отображение товаров на сайте.
Конструктор класса содержит контейнер и события.
Поля класса содержат инфо товара и кнопку HTML корзины.
Класс имеет такие методы:
• set title - для установки названия товара;
• set price - для установки цены товара;
• set index - для установки индекса товара;
• set image - для установки изображения товара;
• set description - для установки описание товара;
• set productType - для установки типа товара (софт-скил, другое...).

### Класс Form
Класс отвечает за отображение форм на экране пользователя.
Конструктор класса содержит контейнер и экземпляр брокера событий.
Поля класса содержат кнопку сабмита, ошибки, которые будут вывоводится в случае отрицательной проверки на валидность полей, а также цель (конкретную форму), поля формы и их значения.
Класс имеет такие методы:
• onInputChange - для активации события после изменения содержимого полей формы;
• set vaild - для придания полю вводу валидности;
• set errors - для выведения ошибок при непрохождении поля формы валидации;
• render - для выведения на страницу формы.

### Класс FormPayment
Класс отвечает за первую форму в которую попадает пользователей после нажатия сабмита в форме подтверждения заказа.
Конструктор класса содержит контейнер и события.
Поля класса содержат радио кнопки с выбором способа оплаты, свою кнопку сабмита формы, поле инпут - наследуется от Form.
Класс имеет метод:
• set adress - для установки в инпут пользовательского значения;
• set paymentStatus - для управления классами у элементов кнопок.

### Класс FormContacts
Класс отвечает за форму, в которую пользователь попадает после подвтерждения способа оплата и введения своего адреса.
Конструктор класса содержит контейнер и события.
Поля класса содержат свою кнопку сабмита, два поля инпута - наследуется от Form.
Класс имеет такие методы:
• set phoneNumber - для установки в инпут пользовательского значения;
• set emailAdress - для установки в инпут пользовательского значения.

### Класс Modal
Класс отвечает за логику взаимодействия и отображения модальных окон.
Конструктор класса содержит контейнер и события.
Поля класса содержат кнопки закрытия модальных окон и контент, отображаемый в модальом окне.
Класс имеет такие методы:
• set content - для установки содержимого компонента;
• open - для добавления класса 'modal_active' и выведение модального окна на экран пользователя;
• close - для удаления класса 'modal_active' у переданного элемента и сокрытие его с экрана пользователя;
• render - для выведения модального окна посредством метода Component с добавлением метода open у Modal. 

### Класс Success
Класс отвечает отображение модального окна успешно сделанного заказа.
Конструктор класса содержит контейнер и события.
Поля класса содержат кнопку и описание успешно завершенной покупки.
Класс имеет такие методы:
• set success - для заполнения поля успешно завершенной покупки.

### Класс Page
Класс отвечает за отображение страницы на экране пользователя.
Конструктор класса содержит контейнер и события.
Поля класса содержат HTML элементы относящие к корзине покупок на сайте.
Класс имеет такие методы:
• set counter - для отображения количества товаров добавленных в корзину; 
• set catalog - для отображения перечня возмжных к покупке позиций;
• set locked - для контроля состояния страницы при открытых модальных окнах;

## Модели данных

### Класс Model
Класс отвечает за работу с базовым кодом модели данных
Класс имеет метод:
• emitChanges - сообщает, что модель изменилась и вызывает событие.

### Класс AppDataBasket
Класс отвечает за логику работы корзины на сайте. Дочерний класс классу Model.
Класс имеет такие методы:
• add(id: string): void - для добавления в корзину товара;
• remove(id: string): void - для того, чтобы убрать товар из корзины по клику;
• clearBasket(): void - для очистки корзины;
• getTotal(id: string): number - для подсчета количества добавленных в корзину товаров;
• hasItem(): boolean - для проверки наличия определенного (по id) товара в корзине;
• makeOrderArray(items: IWebLarekDataID): [] - для формирования массива состоящего из id товаров выбранных пользователей с целью его использования при отправке заказа на сервер.

### Класс AppDataForm
Класс отвечает за текущее состояние формы на сайте.
Класс содержит в себе все данные формы, а также, данные ошибок.
Класс имеет такие методы:
• setField - для установки состояния инпута;
• clearForm - для очистки полей формы;
• validateFormPayment - для валидации формы с выбором способа оплаты;
• validateFormContacts - для валидации формы с контактами пользователя;
• sendOrder - для возвращения объекта с данными с целью формирования заказ на сервер.

### Класс AppDataProductsList
Класс отвечает за состояние товаров указанных на сайте.
Класс содержит массив из всех товаров.
Класс имеет такие методы:
• setProducts - для того, чтобы внести товары в общий список товаров на сайте;
• getProduct - для того, чтобы получить доступ к необходиму товару из массива;
• getProducts - для получения всего массива товаров.


